# Power Master / Hinen 6.0K-SL
# Device Code: 3501
# Solarman protocol lookup
# Custom for Do Thai

info:
  manufacturer: Power Master
  model: 6.0K-SL
  device_code: 3501
  phase: single
  type: hybrid

default:
  update_interval: 30
  code: 0x03
  digits: 2

parameters:

  # ================= GRID =================
  - group: Grid
    update_interval: 5
    items:
      - name: Grid Voltage
        registers: [67]          # RAW_67 = 4600 → 460.0V
        rule: 1
        scale: 0.1
        uom: V
        device_class: voltage
        state_class: measurement

      - name: Grid Frequency
        registers: [89]          # RAW_89 = 5020 → 50.20Hz
        rule: 1
        scale: 0.01
        uom: Hz
        device_class: frequency
        state_class: measurement

  # ================= LOAD =================
  - group: Load
    update_interval: 5
    items:
      - name: Load Power
        registers: [75]          # RAW_75 = 1000
        rule: 1
        uom: W
        device_class: power
        state_class: measurement

  # ================= BATTERY =================
  - group: Battery
    update_interval: 5
    items:
      - name: Battery SOC
        registers: [96]          # RAW_96 = 100 (%)
        rule: 1
        uom: "%"
        device_class: battery
        state_class: measurement

      - name: Battery Voltage
        registers: [99]          # RAW_99 = 484 → 48.4V
        rule: 1
        scale: 0.1
        uom: V
        device_class: voltage
        state_class: measurement

      - name: Battery Current
        registers: [87]          # RAW_87 = 24 → 2.4A
        rule: 1
        scale: 0.1
        uom: A
        device_class: current
        state_class: measurement

  # ================= PV =================
  - group: PV
    update_interval: 5
    items:
      - name: PV Voltage
        registers: [101]         # RAW_101 = 2116 → 211.6V
        rule: 1
        scale: 0.1
        uom: V
        device_class: voltage
        state_class: measurement

      - name: PV Power
        registers: [124]         # RAW_124 = 5888 → 588.8W
        rule: 1
        scale: 0.1
        uom: W
        device_class: power
        state_class: measurement

  # ================= ENERGY =================
  - group: Energy
    update_interval: 30
    items:
      - name: Today PV Production
        registers: [124]
        rule: 1
        scale: 0.1
        uom: kWh
        device_class: energy
        state_class: total_increasing

      - name: Total PV Production
        registers: [123, 124]    # 32-bit
        rule: uint32
        scale: 0.001
        uom: kWh
        device_class: energy
        state_class: total_increasing
