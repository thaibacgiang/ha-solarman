# Power Master / Hinen 6.0K-SL
# Device Code: 3501
# Solarman protocol lookup
# Author: ChatGPT (custom for Do Thai)
# Base: deye_hybrid (adjusted scale & registers)

info:
  manufacturer: Power Master
  model: 6.0K-SL
  device_code: 3501
  phase: single
  type: hybrid

default:
  update_interval: 30
  code: 0x03
  digits: 2

parameters:

# =====================
# DEVICE
# =====================
  - group: Device
    update_interval: 5
    items:
      - name: Device State
        class: enum
        rule: 1
        registers: [500]
        lookup:
          - key: 0
            value: Stand-by
          - key: 1
            value: Grid-connected
          - key: 2
            value: Off-grid
          - key: 3
            value: Fault
          - key: 4
            value: Charging
          - key: 5
            value: Discharging

      - name: Inverter Temperature
        class: temperature
        state_class: measurement
        uom: "°C"
        scale: 0.1
        rule: 1
        registers: [541]

# =====================
# PV
# =====================
  - group: PV
    update_interval: 5
    items:
      - name: PV Power
        class: power
        state_class: measurement
        uom: W
        rule: 2
        scale: 1
        registers: [672, 673]
        icon: mdi:solar-power

      - name: PV1 Voltage
        class: voltage
        state_class: measurement
        uom: V
        scale: 0.1
        rule: 1
        registers: [676]

      - name: PV1 Current
        class: current
        state_class: measurement
        uom: A
        scale: 0.01
        rule: 1
        registers: [677]

      - name: PV2 Voltage
        class: voltage
        state_class: measurement
        uom: V
        scale: 0.1
        rule: 1
        registers: [678]

      - name: PV2 Current
        class: current
        state_class: measurement
        uom: A
        scale: 0.01
        rule: 1
        registers: [679]

# =====================
# GRID / AC
# =====================
  - group: AC
    update_interval: 5
    items:
      - name: Grid Voltage
        class: voltage
        state_class: measurement
        uom: V
        scale: 0.1
        rule: 1
        registers: [598]

      - name: Grid Current
        class: current
        state_class: measurement
        uom: A
        scale: 0.01
        rule: 1
        registers: [599]

      - name: Grid Frequency
        class: frequency
        state_class: measurement
        uom: Hz
        scale: 0.01
        rule: 1
        registers: [600]

      - name: Load Power
        class: power
        state_class: measurement
        uom: W
        rule: 2
        scale: 1
        registers: [604, 605]
        icon: mdi:home-lightning-bolt

# =====================
# BATTERY
# =====================
  - group: Battery
    update_interval: 5
    items:
      - name: Battery SOC
        class: battery
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [628]

      - name: Battery Voltage
        class: voltage
        state_class: measurement
        uom: V
        scale: 0.01
        rule: 1
        registers: [629]

      - name: Battery Current
        class: current
        state_class: measurement
        uom: A
        scale: 0.01
        rule: 1
        registers: [630]

      - name: Battery Power
        class: power
        state_class: measurement
        uom: W
        rule: 1
        registers: [631]

      - name: Battery Temperature
        class: temperature
        state_class: measurement
        uom: "°C"
        scale: 0.1
        rule: 1
        registers: [632]

# =====================
# ENERGY
# =====================
  - group: Energy
    update_interval: 30
    items:
      - name: Today PV Production
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 1
        registers: [690]

      - name: Total PV Production
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 2
        registers: [692, 693]

      - name: Today Load Consumption
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 1
        registers: [694]

      - name: Total Load Consumption
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 2
        registers: [696, 697]

      - name: Today Energy Import
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 1
        registers: [700]

      - name: Total Energy Import
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 2
        registers: [702, 703]

      - name: Today Energy Export
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 1
        registers: [704]

      - name: Total Energy Export
        class: energy
        state_class: total_increasing
        uom: kWh
        scale: 0.1
        rule: 2
        registers: [706, 707]
