# Hinen Inverter
#
# Reference: Modbus RTU Protocol Document
# Tested with Hinen H5000-EU Single-Phase Hybrid Model Number: S05U01T00E0FP0500B0500
#

info:
  manufacturer: Hinen
  model: H5000

default:
  update_interval: 30
  code: 0x03  # Sử dụng function code 0x03 để đọc thanh ghi
  digits: 4

parameters:
  - group: Device
    update_interval: 5
    items:
      - name: "Device State"
        class: "enum"
        rule: 1
        registers: [59]  # Address 059: run state
        icon: "mdi:state-machine"
        lookup:
          - key: 0
            value: "Stand-by"
          - key: 1
            value: "Grid-connected"
          - key: 2
            value: "Off-grid"
          - key: 3
            value: "FAULT"
          - key: 4
            value: "Update mode"
          - key: 5
            value: "Charging"
          - key: 6
            value: "Discharging"
          - key: 7
            value: "Bypass"

     sensor:

  # =====================
  # THÔNG TIN LƯỚI
  # =====================

  - name: "Sunsynk Grid Voltage"
    slave: 1
    address: 67
    input_type: holding
    unit_of_measurement: "V"
    device_class: voltage
    scale: 0.1
    precision: 1

  - name: "Sunsynk Grid Frequency"
    slave: 1
    address: 79
    input_type: holding
    unit_of_measurement: "Hz"
    device_class: frequency
    scale: 0.01
    precision: 2

  - name: "Sunsynk Grid Current"
    slave: 1
    address: 76
    input_type: holding
    unit_of_measurement: "A"
    device_class: current
    scale: 0.1
    precision: 1

  # =====================
  # CÔNG SUẤT
  # =====================

  - name: "Sunsynk Output Power"
    slave: 1
    address: 86
    input_type: holding
    unit_of_measurement: "W"
    device_class: power
    scale: 0.1
    precision: 0

  - name: "Sunsynk Input Power"
    slave: 1
    address: 82
    input_type: holding
    unit_of_measurement: "W"
    device_class: power
    scale: 0.1
    precision: 0

  # =====================
  # SẢN LƯỢNG
  # =====================

  - name: "Sunsynk Daily Energy"
    slave: 1
    address: 60
    input_type: holding
    unit_of_measurement: "kWh"
    device_class: energy
    state_class: total_increasing
    scale: 0.1
    precision: 1

  - name: "Sunsynk Total Energy"
    slave: 1
    address: 63
    input_type: holding
    unit_of_measurement: "kWh"
    device_class: energy
    state_class: total_increasing
    scale: 0.1
    precision: 1

  # =====================
  # PV
  # =====================

  - name: "Sunsynk PV Daily Energy"
    slave: 1
    address: 108
    input_type: holding
    unit_of_measurement: "kWh"
    device_class: energy
    state_class: total_increasing
    scale: 0.1
    precision: 1

  - name: "Sunsynk PV1 Voltage"
    slave: 1
    address: 109
    input_type: holding
    unit_of_measurement: "V"
    device_class: voltage
    scale: 0.1
    precision: 1

  - name: "Sunsynk PV1 Current"
    slave: 1
    address: 110
    input_type: holding
    unit_of_measurement: "A"
    device_class: current
    scale: 0.1
    precision: 1

  - name: "Sunsynk PV2 Voltage"
    slave: 1
    address: 111
    input_type: holding
    unit_of_measurement: "V"
    device_class: voltage
    scale: 0.1
    precision: 1

  - name: "Sunsynk PV2 Current"
    slave: 1
    address: 112
    input_type: holding
    unit_of_measurement: "A"
    device_class: current
    scale: 0.1
    precision: 1

  # =====================
  # NHIỆT ĐỘ
  # =====================

  - name: "Sunsynk Inverter Temperature"
    slave: 1
    address: 90
    input_type: holding
    unit_of_measurement: "°C"
    device_class: temperature
    scale: 0.1
    precision: 1

  - name: "Sunsynk Environment Temperature"
    slave: 1
    address: 95
    input_type: holding
    unit_of_measurement: "°C"
    device_class: temperature
    scale: 0.1
    precision: 1

  # =====================
  # TRẠNG THÁI
  # =====================

  - name: "Sunsynk Run State"
    slave: 1
    address: 59
    input_type: holding

  - name: "Sunsynk Warning Code"
    slave: 1
    address: 101
    input_type: holding

  - name: "Sunsynk Fault Code"
    slave: 1
    address: 103
    input_type: holding
